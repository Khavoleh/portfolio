---
import type { ExperienceItem, ExperienceSection } from './interfaces.ts';
import { EXPERIENCE_DATA } from './constants.ts';
import type { Skill } from '@shared/skill/interfaces.ts';
import SkillBlock from '@shared/skill/SkillBlock.astro';
import { useTranslations } from '@shared/helpers.ts';
import { EXPERIENCE_DATA_TRANSLATIONS } from './translations.ts';

const t = useTranslations(Astro.url, EXPERIENCE_DATA_TRANSLATIONS);
---

<div class="relative">
  {
    EXPERIENCE_DATA.map((experience: ExperienceItem) => (
      <div class="relative">
        <div class="absolute top-20 bottom-0 left-8 w-0.5 bg-gradient-to-b from-blue-500 to-blue-300 md:left-1/2 md:-ml-px dark:from-blue-400 dark:to-blue-600" />

        <div class="absolute top-8 left-8 -ml-3 md:left-1/2 md:-ml-4">
          <div class="h-6 w-6 rounded-full border-4 border-blue-500 bg-white md:h-8 md:w-8 dark:border-blue-400 dark:bg-slate-900" />
        </div>

        <div class="ml-24 md:ml-0 md:w-full">
          <div class="mb-16 md:grid md:grid-cols-2 md:gap-12">
            <div class="md:text-right">
              <div class="background-default border-default mb-6 rounded-2xl border-2 p-6 shadow-lg md:ml-auto md:max-w-lg">
                <div class="mb-3">
                  <h2 class="text-primary mb-2 text-2xl font-bold">{t(experience.role)}</h2>
                  <p class="text-lg font-semibold text-blue-600 dark:text-blue-400">{t(experience.company)}</p>
                  <p class="text-primary font-semibold">{t(experience.sector)}</p>
                  <p class="text-secondary mt-1 text-sm">{t(experience.period)}</p>
                </div>

                <div class="flex flex-wrap justify-start gap-3 md:justify-end">
                  {experience.skills.map((skill: Skill) => (
                    <SkillBlock skill={skill} />
                  ))}
                </div>
              </div>
            </div>

            <div class="space-y-6">
              {experience.sections.map((section: ExperienceSection) => (
                <div class="background-default border-default rounded-2xl border-2 p-6 shadow-lg">
                  <h3 class="text-primary mb-3 flex items-center text-xl font-bold">
                    <section.icon class="mr-2 shrink-0 text-2xl" />
                    {t(section.title)}
                  </h3>
                  <p class="text-secondary leading-relaxed font-medium">{t(section.details)}</p>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    ))
  }
</div>
