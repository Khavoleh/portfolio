---
import type { ExperienceItem } from './constants';

interface Props {
  experience: ExperienceItem;
  isLast?: boolean;
}

const { experience, isLast = false } = Astro.props;
---

<div class="relative">
  <!-- Timeline Line -->
  {
    !isLast && (
      <div class="absolute top-20 bottom-0 left-8 w-0.5 bg-gradient-to-b from-blue-500 to-blue-300 md:left-1/2 md:-ml-px dark:from-blue-400 dark:to-blue-600"></div>
    )
  }

  <!-- Timeline Node -->
  <div class="absolute top-8 left-8 -ml-3 md:left-1/2 md:-ml-4">
    <div
      class="h-6 w-6 rounded-full border-4 border-blue-500 bg-white md:h-8 md:w-8 dark:border-blue-400 dark:bg-slate-900"
    >
    </div>
  </div>

  <!-- Content Card -->
  <div class="ml-24 md:ml-0 md:w-full">
    <div class="mb-16 md:grid md:grid-cols-2 md:gap-8">
      <!-- Left side on desktop (right side content for odd items) -->
      <div class={`md:text-right ${isLast ? '' : ''}`}>
        <!-- Role & Company -->
        <div class="background-default border-default mb-6 rounded-2xl border-2 p-6 shadow-lg md:ml-auto md:max-w-lg">
          <div class="mb-3">
            <h3 class="text-primary mb-2 text-2xl font-bold">
              {experience.role}
            </h3>
            <p class="text-lg font-semibold text-blue-500 dark:text-blue-400">
              {experience.company}
            </p>
            <p class="text-secondary mt-1 text-sm">
              {experience.period}
            </p>
          </div>

          <!-- Focus Tags -->
          <div class="mt-4 flex flex-wrap gap-2 md:justify-end">
            {
              experience.focus.map((tag) => (
                <span class="rounded-full bg-blue-100 px-3 py-1 text-xs font-medium text-blue-700 dark:bg-blue-900 dark:text-blue-300">
                  {tag}
                </span>
              ))
            }
          </div>
        </div>
      </div>

      <!-- Right side on desktop (left side content for odd items) -->
      <div class="space-y-6">
        <!-- Challenge -->
        <div class="background-default border-default rounded-2xl border-2 p-6 shadow-lg">
          <h4 class="text-primary mb-3 flex items-center text-xl font-bold">
            <span class="mr-2 text-2xl">üéØ</span>
            {experience.challenge.title}
          </h4>
          <p class="text-secondary leading-relaxed">
            {experience.challenge.description}
          </p>
        </div>

        <!-- Solution -->
        <div class="background-default border-default rounded-2xl border-2 p-6 shadow-lg">
          <h4 class="text-primary mb-3 flex items-center text-xl font-bold">
            <span class="mr-2 text-2xl">üîß</span>
            {experience.solution.title}
          </h4>
          <ul class="text-secondary space-y-3">
            {
              experience.solution.details.map((detail) => (
                <li class="flex items-start">
                  <span class="mt-1 mr-2 text-blue-500 dark:text-blue-400">‚ñ™</span>
                  <span class="leading-relaxed">{detail}</span>
                </li>
              ))
            }
          </ul>
        </div>

        <!-- Frontend (if exists) -->
        {
          experience.frontend && (
            <div class="background-default border-default rounded-2xl border-2 p-6 shadow-lg">
              <h4 class="text-primary mb-3 flex items-center text-xl font-bold">
                <span class="mr-2 text-2xl">üé®</span>
                {experience.frontend.title}
              </h4>
              <ul class="text-secondary space-y-3">
                {experience.frontend.details.map((detail) => (
                  <li class="flex items-start">
                    <span class="mt-1 mr-2 text-blue-500 dark:text-blue-400">‚ñ™</span>
                    <span class="leading-relaxed">{detail}</span>
                  </li>
                ))}
              </ul>
            </div>
          )
        }

        <!-- Leadership (if exists) -->
        {
          experience.leadership && (
            <div class="background-default border-default rounded-2xl border-2 p-6 shadow-lg">
              <h4 class="text-primary mb-3 flex items-center text-xl font-bold">
                <span class="mr-2 text-2xl">üë•</span>
                {experience.leadership.title}
              </h4>
              <p class="text-secondary leading-relaxed">{experience.leadership.description}</p>
            </div>
          )
        }

        <!-- Impact -->
        <div class="background-default border-default rounded-2xl border-2 p-6 shadow-lg">
          <h4 class="text-primary mb-3 flex items-center text-xl font-bold">
            <span class="mr-2 text-2xl">üìà</span>
            {experience.impact.title}
          </h4>
          <p class="text-secondary leading-relaxed">
            {experience.impact.description}
          </p>
        </div>

        <!-- Stack -->
        <div class="background-default border-default rounded-2xl border-2 p-6 shadow-lg">
          <h4 class="text-primary mb-3 flex items-center text-xl font-bold">
            <span class="mr-2 text-2xl">‚öôÔ∏è</span>
            {experience.stack.title}
          </h4>
          <p class="text-secondary leading-relaxed font-medium">
            {experience.stack.technologies}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
